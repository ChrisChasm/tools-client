{"version":3,"sources":["src/app.js","src/environment.js","src/main.js","src/services/Documents.js","src/services/authservice.js","src/services/fileservice.js","src/services/http.js","src/shared/entity.js","src/components/editor/editor.js","src/components/documents/documents.js","src/components/icon/icon.js","src/components/genmap/genmap.js","src/components/login/login.js","src/components/mapvarients/mapvarients.js","/Users/garrettcox/Development/gen-mapper-app/src/components/signup/signup.js","src/components/texteditor/texteditor.js","src/components/map/genmapper.js","src/components/map/map.js","src/components/map/templates.js","src/views/category/category.js","src/views/home/home.js","src/views/tool/tool.js"],"names":["App","configureRouter","config","router","map","moduleId","route","name","debug","testing","configure","aurelia","use","standardConfiguration","globalResources","developmentLogging","plugin","start","then","setRoot","Documents","http","getAll","get","create","body","post","id","update","put","delete","SUCCESS","User","options","entityType","Object","assign","AuthService","handler","loggedIn","onLogin","login","user","console","log","sessionStorage","setItem","response","content","data","signup","status","setEntity","d","FileService","eventAggregator","currentChanged","file","publish","all","getDocuments","list","doc","select","current","handleError","err","message","Http","x","withBaseUrl","withHeader","getItem","url","catch","format","item","entity","deleteEntity","Entity","Document","props","dirty","titleChanged","contentChanged","Editor","documents","docService","docs","currentDoc","loadedDoc","refreshDocs","setDoc","index","reduce","c","i","Error","startNew","importFile","save","updated","created","$event","currentId","stopPropagation","length","title","formats_types","obj","DocumentsViewModel","fileService","activate","params","formatId","type","saveDoc","loadDoc","navigate","createDocument","removeDocument","Icon","Element","element","nameChanged","setAttribute","GenMapViewModel","showDocumentList","mapType","auth","Login","email","password","onSubmit","event","preventDefault","MapVarientsViewModel","TextEditor","defaultBindingMode","twoWay","loaded","_contentChanged","_content","templates","GenMapper","model","template","attached","isAttached","appVersion","loadHTMLContent","margin","top","right","bottom","left","projectName","addFieldsToEditWindow","d3","text","on","userInput","window","prompt","trim","displayAlert","zoom","scaleExtent","zoomed","attr","transform","setSvgHeight","svg","call","g","append","gLinks","gLinksText","gNodes","csvHeader","fields","field","header","join","initialCsv","initial","parseCsvData","nodes","validTree","origPosition","redraw","alertElement","document","getElementById","editGroupElement","editFieldElements","forEach","values","value","editParentElement","setKeyboardShorcuts","getElementsByTagName","onresize","templateContent","addEventListener","e","keyCode","style","display","click","windowHeight","documentElement","clientHeight","leftMenuHeight","height","Math","max","innerHTML","zoomIn","scaleBy","zoomOut","scaleTo","origX","clientWidth","origY","parsedTransform","parseTransform","translateBy","translate","onLoad","fileInputElementId","fileInput","closeAlert","introSwitchVisibility","tmp","popupEditGroupModal","checked","keys","parent","groupData","group","editGroup","removeNode","importFileSubtree","printMap","printType","arrNodes","descendants","minX","maxX","minY","maxY","y","min","origWidth","origHeight","origTransform","totalHeight","totalWidthLeft","totalWidthRight","translateX","translateY","printHeight","printWidth","printScale","selectAll","print","tree","nodeSize","settings","width","separation","a","b","stratifiedData","stratify","link","slice","exit","remove","enter","merge","LINK_TEXT_POSITION","linkText","active","coach","node","newGroup","appendRemoveButton","appendAddButton","svgElement","svgElementValue","attributes","attribute","styleKey","nodeWithNew","addNode","updateSvgForFields","inheritsFrom","updateFieldWithInherit","empty","updateCheckboxField","updateRadioField","class","class_","checkedTrue","checkedFalse","classList","rx","rxObj","String","fieldValue","getFieldValueForRadioType","baseVal","valueAsString","_","where","html","newNodeData","findNewId","push","ids","row","findNewIdFromArray","arr","sort","confirmMessage","children","confirm","deleteAllDescendants","nodeToDelete","without","csvData","csvParse","parsedId","parseInt","isNaN","parsedLine","parentId","toUpperCase","includes","getCSVOut","csvFormatRows","output","outputString","outputCsv","out","blob","Blob","isSafari","navigator","vendor","indexOf","userAgent","match","promptMessage","saveName","saveAs","shift","importFileFromInput","filedata","filename","parsedCsv","parseAndValidateCsv","csvIntoNode","csvString","fileToCsvString","displayImportError","treeTest","stratifiedDataTest","toString","idsToDelete","pop","childrenIdsToDelete","concat","rowRootOfImported","mapOldIdToNewId","idsUnsorted","newId","callback","FileReader","input","files","fr","onload","result","extension","exec","readAsText","readAsBinaryString","regex","toLowerCase","workbook","XLSX","read","worksheet","Sheets","SheetNames","utils","sheet_to_csv","replace","substring","tr","description","td","MapViewModel","of","genmapper","boxHeight","textHeight","textMargin","CHURCH_CIRCLES","Category","Home","categories","tools","image","Tool","canPersist","editorDirty","titleDirty","load"],"mappings":"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","file":"app-bundle.js","sourcesContent":["\nexport class App {\n  configureRouter(config, router) {\n    config.map([\n      {\n        moduleId: 'views/home/home',\n        route: [''],\n        name: 'home'\n      },\n      {\n        moduleId: 'views/category/category',\n        route: 'categories/:id',\n        name: 'category'\n      },\n      {\n        moduleId: 'views/tool/tool',\n        route: 'tools/:id',\n        name: 'tool'\n      }\n    ]);\n    this.router = router;\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .globalResources('components/icon/icon');\n    // .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import { inject } from 'aurelia-framework';\nimport { Http } from 'services/http';\n\n@inject(Http)\nexport class Documents {\n  constructor(http) {\n    this.http = http;\n  }\n\n  getAll() {\n    return this.http.get('/documents');\n  }\n\n  create(body) {\n    return this.http.post('/documents', body);\n  }\n\n  get(id) {\n    return this.http.get(`/documents/${id}`);\n  }\n\n  update(id, body) {\n    return this.http.put(`/documents/${id}`, body);\n  }\n\n  delete(id) {\n    return this.http.delete(`/documents/${id}`);\n  }\n}\n","import { inject } from 'aurelia-framework';\nimport { HttpClient } from 'aurelia-http-client';\nimport { Http } from 'services/http'\n\nconst SUCCESS = 'success';\nclass User {\n    entityType: string = 'users';\n    email: string;\n    password: string;\n    constructor(options: {}) {\n        Object.assign(this, options);\n    }\n}\n\n@inject(Http)\nexport class AuthService {\n    \n    loggedIn: Boolean = false;\n\n    constructor(handler) {\n        this.handler = handler;\n        this.http = handler.http;\n    }\n\n    onLogin() {\n        return;\n    }\n\n    login(user: User) {\n        user.entityType = 'auth'\n        return this.handler.create(user)\n            .then(response => {\n                console.log('loggedIn')\n                sessionStorage.setItem('auth_token', response.content.data);\n                this.loggedIn = true;\n                this.handler.configure();\n                return this.onLogin();\n            })\n    }\n\n    signup(user: User) {\n        user = new User(user);\n        return this.handler.create(user)\n            .then( response => {\n                if (response.status === SUCCESS) {\n                    this.user = new User(response.data);\n                    return this.login(user);\n                }\n            })\n            \n    }\n}","import { EventAggregator } from 'aurelia-event-aggregator';\nimport { inject, observable } from 'aurelia-framework';\nimport { Http } from 'services/http';\n\nfunction setEntity(d) {\n    d.entityType = d.entityType || 'documents';\n}\n\n@inject(EventAggregator, Http)\nexport class FileService {\n\n    @observable current = null;\n\n    @observable list = null;\n\n    constructor(eventAggregator: EventAggregator, http: Http) {\n        this.eventAggregator = eventAggregator;\n        this.http = http;\n    }\n\n    currentChanged(file) {\n        this.eventAggregator.publish('file-changed', file);\n    }\n\n    all() {\n        return this.http.getDocuments().then(list => {\n            this.list = list;\n            console.log(this.list)\n            return this.list;\n        })\n    }\n\n    create(doc) {\n        setEntity(doc);\n        return this.http.create(doc);\n    }\n\n    update(doc) {\n        setEntity(doc);\n        console.log(doc)\n        return this.http.update(doc)\n    }\n\n    delete(doc) {\n        setEntity(doc)\n        return this.http.delete(doc)\n    }\n\n    select(doc) {\n        this.current = doc;\n    }\n}\n\n\n\nfunction getDocuments() {\n    return [\n        { name: 'Document 1'},\n        { name: 'Document 2'},\n        { name: 'Document 3'},\n        { name: 'Document 4'},\n        { name: 'Document 5'},\n        { name: 'Document 6'},\n        { name: 'Document 7'},\n    ]\n}\n","import { HttpClient } from 'aurelia-http-client';\nimport { inject } from 'aurelia-framework';\nimport { Entity } from 'shared/entity';\n\nfunction handleError(err) {\n  console.log(err.content.message);\n}\n\n@inject(HttpClient)\nexport class Http {\n  constructor(http: HttpClient) {\n    this.http = http;\n    this.configure();\n  }\n\n  configure() {\n    this.http.configure(x => {\n      x.withBaseUrl('http://genmap.garrettcox.io');\n      x.withHeader('Authorization', 'bearer ' + sessionStorage.getItem('auth_token'));\n    });\n  }\n\n  get(url) {\n    return this.http\n      .get(url)\n      .then(response => response.content.data)\n      .catch(handleError);\n  }\n\n  post(url, body) {\n    return this.http\n      .post(url, body)\n      .then(response => response.content.data)\n      .catch(handleError);\n  }\n\n  put(url, body) {\n    return this.http\n      .put(url, body)\n      .then(response => response.content.data)\n      .catch(handleError);\n  }\n\n  delete(url) {\n    return this.http\n      .delete(url)\n      .then(response => response.content.data)\n      .catch(handleError);\n  }\n\n  getAll(url: string) {\n    return this.http\n    .get(url)\n    .then(d => d.content)\n    .catch(handleError);\n  }\n\n  getDocuments(format) {\n    return this.getAll('documents')\n    .then(d => {\n      return d.data.map(item => {\n        item.entityType = 'documents';\n        return item;\n      });\n    });\n  }\n\n  create(entity: Entity = null) {\n    return this.http\n    .post(entity.entityType, entity)\n    .catch(handleError);\n  }\n\n  update(entity: Entity = null) {\n    const url = `${entity.entityType}/${entity.id}`;\n    return this.http\n    .put(url, entity)\n    .catch(handleError);\n  }\n\n  deleteEntity(entity: Entity = null) {\n    const url = `${entity.entityType}/${entity.id}`;\n    return this.http\n    .delete(url)\n    .catch(handleError);\n  }\n}\n","export class Entity {\n    entityType: string;\n    guid: string;\n}","import { inject, observable } from 'aurelia-framework';\nimport { Documents } from 'services/Documents';\n\nclass Document {\n  @observable title;\n  @observable content;\n\n  constructor(props) {\n    Object.assign(this, props);\n    this.dirty = false;\n  }\n\n  titleChanged() {\n    this.dirty = true;\n  }\n\n  contentChanged() {\n    this.dirty = true;\n  }\n}\n\n@inject(Documents)\nexport class Editor {\n  constructor(documents) {\n    this.docService = documents;\n    this.docs = [];\n    this.currentDoc = {};\n    this.loadedDoc = false;\n\n    this.refreshDocs();\n  }\n\n  get empty() {\n    return !this.docs.length;\n  }\n\n  get canCreate() {\n    return !!this.currentDoc.title;\n  }\n\n  get isDirty() {\n    return this.currentDoc.dirty;\n  }\n\n  refreshDocs() {\n    return this.docService.getAll()\n      .then(docs => {\n        if (docs) this.docs = docs.map(d => new Document(d));\n      });\n  }\n\n  setDoc(id) {\n    this.refreshDocs()\n      .then(() => {\n        const index = this.docs.reduce((d, c, i) => {\n          if (d === -1 && c.id === id) return i;\n          return d;\n        }, -1);\n\n        if (index === -1) throw new Error('Invalid doc id');\n\n        this.currentDoc = this.docs[index];\n        this.loadedDoc = true;\n      });\n  }\n\n  startNew() {\n    this.loadedDoc = false;\n    this.currentDoc = {};\n  }\n\n  importFile() {\n\n  }\n\n  save() {\n    this.docService.update(this.currentDoc.id, this.currentDoc)\n      .then((updated) => {\n        return this.refreshDocs()\n          .then(() => this.setDoc(updated.id));\n      });\n  }\n\n  create() {\n    this.currentDoc.format = 'churchCircles';\n    this.docService.create(this.currentDoc)\n      .then(created => {\n        return this.refreshDocs()\n          .then(() => this.setDoc(created.id));\n      });\n  }\n\n  delete(id, $event) {\n    const currentId = this.currentDoc.id;\n    $event.stopPropagation();\n\n    this.docService.delete(id)\n      .then(() => this.refreshDocs())\n      .then(() => () => {\n        if (currentId === id) this.startNew();\n        else return this.setDoc(currentId);\n      });\n  }\n}\n","import { FileService } from 'services/fileservice';\nimport { inject } from 'aurelia-framework';\nimport { Router } from 'aurelia-router';\nimport { Http } from 'services/http';\n\nconst formats_types = {\n    'church-circles': 'churchCircles',\n    'four-fields': 'fourFields'\n}\n\nclass Document {\n    id: string;\n    entityType: string = 'documents';\n    title: string = 'New Document';\n    format: string;\n    content: string = `id,parentId,name,email,link,attenders,believers,baptized,newlyBaptized,church,churchType,elementBaptism,elementWord,elementPrayer,elementLordsSupper,elementGive,elementLove,elementWorship,elementLeaders,elementMakeDisciples,place,date,threeThirds,active\n    0,,Leader's Name,,,0,0,0,0,0,newBelievers,0,0,0,0,0,0,0,0,0,Place,Date,1234567,1`;\n    constructor(obj = {}) {Object.assign(this, obj)};\n}\n\n@inject(Router, Http, FileService)\nexport class DocumentsViewModel {\n    \n    constructor(router, http, fileService) {\n        this.router = router;\n        this.http = http;\n        this.fileService = fileService;\n    }\n\n    activate(params) {\n        this.formatId = params.type;\n        this.formatId = formats_types[this.formatId];\n        const d = new Document();\n        this.fileService.all();\n    }\n    \n    saveDoc(doc) {\n        this.fileService.update(doc);\n    }\n\n    loadDoc(doc) {\n        this.fileService.select(doc);\n        this.router.navigate(doc.title);\n    }\n\n    createDocument() {\n        let doc = new Document();\n        doc.format = this.formatId;\n        \n        this.fileService.create(doc)\n            .then(()=> this.fileService.all());\n    }\n\n    removeDocument(doc) {\n        this.fileService.delete(doc)\n            .then(()=> this.fileService.all());\n    }\n}\n\n","import { customElement, bindable, inject } from 'aurelia-framework';\n\n@customElement('icon')\n@inject(Element)\nexport class Icon {\n    @bindable name: string = null;\n\n    constructor(element: Element) {\n        this.element = element;\n    }\n\n    nameChanged(name) {\n        this.element.setAttribute('style', `background-image: url(assets/icons/${name}.svg)`);\n    }\n}\n","export class GenMapViewModel {\n\n    showDocumentList = false;\n\n    activate(params) {\n        this.mapType = params.type;\n    }\n    \n    configureRouter(config, router) {\n        config.map([\n            {\n                moduleId: 'components/documents/documents',\n                route: ['', 'documents'],\n                name: 'documents',\n                auth: true,\n            },\n            {\n                moduleId: 'components/import/import',\n                route: ['import'],\n                name: 'import',\n                auth: true,\n            },\n            {\n                moduleId: 'components/map/map',\n                route: [':id'],\n                name: 'map',\n                auth: true,\n            }\n        ]);\n\n        this.router = router;\n    }\n}","import {AuthService} from 'services/authservice';\nimport {Router} from 'aurelia-router';\nimport {inject} from 'aurelia-framework';\n\n@inject(AuthService, Router)\nexport class Login {\n    \n    email = null;\n    password = null;\n\n    constructor(auth, router) {\n        this.auth = auth;\n        this.router = router;\n    }\n\n    onSubmit(event: Event = null): void {\n        event.preventDefault();\n        this.login();\n    }\n\n    login() {\n\n        const email = this.email; \n        const password = this.password;\n        let user = {email, password};\n        this.auth.login(user)\n            .then(()=> {\n                this.router.navigate('');\n            })\n    }\n}","export class MapVarientsViewModel {\n    constructor() {}\n}",null,"import { customElement, bindable, inject, observable, bindingMode } from 'aurelia-framework';\n\n@customElement('texteditor')\n@inject(Element)\nexport class TextEditor {\n  @bindable({ defaultBindingMode: bindingMode.twoWay }) dirty: boolean = false;\n  loaded = '';\n\n  constructor(element: Element) {\n    this.element = element;\n  }\n\n  @observable _content = '';\n  _contentChanged() {\n    this.dirty = (this.loaded !== this._content);\n  }\n\n  @bindable({ defaultBindingMode: bindingMode.twoWay })\n  get content() {\n    console.log('get');\n    this.loaded = this._content;\n    return this._content;\n  }\n\n  set content(content) {\n    console.log('set', content);\n    this.loaded = content;\n    this._content = content;\n  }\n}\n","\nimport { CHURCH_CIRCLES, boxHeight, textHeight, textMargin } from './templates';\nimport { customElement, inject, observable, useView } from 'aurelia-framework';\n\nconst templates = {\n    'church-circles': CHURCH_CIRCLES\n};\n\n// @useView('components/map/genammper.html')\nexport class GenMapper {\n\n    // GenMapper\n    // App for mapping generations of simple churches\n    // https://github.com/dvopalecky/gen-mapper\n    // Copyright (c) 2016-2017 Daniel Vopalecky, MIT license\n    \n    /* global d3, XLSX, saveAs, FileReader, template, _, Blob, boxHeight */\n    \n    @observable templateFormat;\n\n    @observable templateContent;\n\n\n    constructor(options) {\n        this.format = options.format || 'church-circles';\n        this.model = options.model;\n\n        if (this.format) {\n            this.template = templates[this.format];\n        }\n    }\n\n    attached() {\n        this.isAttached = true;\n\n        this.appVersion = '0.2.11'\n        this.loadHTMLContent()\n\n        this.margin = { top: 50, right: 30, bottom: 50, left: 30 }\n\n        this.projectName = 'Untitled project'\n\n        this.addFieldsToEditWindow()\n\n        d3.select('#project-name')\n            .text(this.projectName)\n            .on('click', ()=> {\n                const userInput = window.prompt('Edit Project name', this.projectName).trim()\n                if (userInput === '') { this.displayAlert(\"Project name can't be empty!\") } else {\n                    this.projectName = userInput\n                    d3.select('#project-name').text(this.projectName)\n                }\n            })\n\n        this.zoom = d3.zoom()\n            .scaleExtent([0.15, 2])\n            .on('zoom', function zoomed() {\n                d3.select('g').attr('transform', d3.event.transform)\n            })\n\n        this.setSvgHeight()\n        this.svg = d3.select('#main-svg')\n            .call(this.zoom)\n            .on('dblclick.zoom', null)\n        this.g = this.svg.append('g')\n            .attr('id', 'maingroup')\n        this.gLinks = this.g.append('g')\n            .attr('class', 'group-links')\n        this.gLinksText = this.g.append('g')\n            .attr('class', 'group-links-text')\n        this.gNodes = this.g.append('g')\n            .attr('class', 'group-nodes')\n\n        this.csvHeader = this.template.fields.map(field => field.header).join(',') + '\\n'\n        this.initialCsv = this.csvHeader + this.template.fields.map(field => field.initial).join(',')\n        this.data = this.parseCsvData(this.initialCsv)\n        this.nodes\n\n        if (this.model && this.model.content) {\n            console.log(this.model.content)\n            this.validTree(this.model.content);\n        }\n\n        this.origPosition()\n        this.redraw()\n\n        this.alertElement = document.getElementById('alert-message')\n        this.editGroupElement = document.getElementById('edit-group')\n        this.editFieldElements = {}\n        this.template.fields.forEach((field) => {\n            if (field.type === 'radio') {\n                field.values.forEach((value) => {\n                    this.editFieldElements[field.header + '-' + value.header] =\n                        document.getElementById('edit-' + field.header + '-' + value.header)\n                })\n            } else if (field.type) {\n                this.editFieldElements[field.header] = document.getElementById('edit-' + field.header)\n            }\n        })\n        this.editParentElement = document.getElementById('edit-parent')\n\n        this.setKeyboardShorcuts()\n\n        document.getElementsByTagName('body')[0].onresize = this.setSvgHeight\n\n        console.log(this.templateContent)\n        \n        \n    }\n\n    // Beginning of function definitions\n    setKeyboardShorcuts() {\n        document.addEventListener('keyup', (e) => {\n            if (e.keyCode === 27) {\n                if (document.getElementById('alert-message').style.display !== 'none') {\n                    document.getElementById('alert-message').style.display = 'none'\n                } else {\n                    if (document.getElementById('intro').style.display !== 'none') {\n                        document.getElementById('intro').style.display = 'none'\n                    }\n                    if (this.editGroupElement.style.display !== 'none') {\n                        this.editGroupElement.style.display = 'none'\n                    }\n                }\n            } else if (e.keyCode === 13) {\n                // hitting enter is like submitting changes in the edit window\n                if (this.editGroupElement.style.display !== 'none') {\n                    document.getElementById('edit-submit').click()\n                }\n            }\n        })\n    }\n\n    setSvgHeight() {\n        const windowHeight = document.documentElement.clientHeight\n        const leftMenuHeight = document.getElementById('left-menu').clientHeight\n        const height = Math.max(windowHeight, leftMenuHeight + 10)\n        d3.select('#main-svg')\n            .attr('height', height)\n    }\n\n    loadHTMLContent() {\n        document.getElementById('left-menu').innerHTML += '<h1>GenMapper</h1>' +\n            '<h2 id=\"project-name\">&nbsp;</h2>' +\n            '<p>Help</p>' +\n            '<button onclick=\"genmapper.introSwitchVisibility()\">Help / About</button>' +\n            '<p>Zooming</p>' +\n            '<button onclick=\"genmapper.origPosition();\">Original Zoom &amp; Position</button>' +\n            '<button onclick=\"genmapper.zoomIn();\">Zoom In</button>' +\n            '<button onclick=\"genmapper.zoomOut();\">Zoom Out</button>' +\n            '<p>Import / Export</p>' +\n            '<button onclick=\"genmapper.onLoad(\\'file-input\\')\">Import XLXS / CSV</button>' +\n            '<input type=\"file\" id=\"file-input\" onchange=\"genmapper.importFile()\" style=\"display:none;\">' +\n            '<button onclick=\"genmapper.outputCsv()\">Export CSV</button>' +\n            '<p>Printing</p>' +\n            '<button onclick=\"genmapper.printMap(\\'vertical\\');\">Print Vertical Multipage</button>' +\n            '<button onclick=\"genmapper.printMap(\\'horizontal\\');\">Print Horizontal One-page</button>'\n\n        document.getElementById('edit-group').innerHTML += '<div id=\"edit-group-content\">' +\n            '  <h1>Edit group</h1>' +\n            '  <form>' +\n            '    <table>' +\n            '      <tr>' +\n            '        <td class=\"left-field\">Parent:</td>' +\n            '        <td class=\"right-field\"><p id=\"edit-parent\"></p></td>' +\n            '      </tr>' +\n            '    </table>' +\n            '  </form>' +\n            '  <div id=\"edit-buttons\">' +\n            '    <button id=\"edit-submit\">Submit changes</button>' +\n            '    <button id=\"edit-cancel\">Cancel</button>' +\n            '    <button id=\"edit-delete\">Delete subtree</button>' +\n            '    <button onclick=\"genmapper.onLoad(\\'file-input-subtree\\')\">Import subtree</button>' +\n            '    <input type=\"file\" id=\"file-input-subtree\" style=\"display:none;\">' +\n            '  </div>' +\n            '</div>'\n\n        document.getElementById('alert-message').innerHTML =\n            '<div id=\"alert-message-content\">' +\n            '  <p id=\"alert-message-text\"></p>' +\n            '  <button onclick=\"genmapper.closeAlert()\">OK</button>' +\n            '</div>'\n\n        document.getElementById('version').innerHTML = this.appVersion\n    }\n\n    zoomIn() {\n        this.zoom.scaleBy(this.svg, 1.2)\n    }\n\n    zoomOut() {\n        this.zoom.scaleBy(this.svg, 1 / 1.2)\n    }\n\n    origPosition() {\n        this.zoom.scaleTo(this.svg, 1)\n        const origX = this.margin.left + (document.getElementById('main').clientWidth / 2)\n        const origY = this.margin.top\n        const parsedTransform = this.parseTransform(this.g.attr('transform'))\n        this.zoom.translateBy(this.svg, origX - parsedTransform.translate[0], origY - parsedTransform.translate[1])\n    }\n\n    onLoad(fileInputElementId) {\n        const fileInput = document.getElementById(fileInputElementId)\n        fileInput.value = ''\n        fileInput.click()\n    }\n\n    displayAlert(message) {\n        this.alertElement.style.display = 'block'\n        document.getElementById('alert-message-text').innerHTML = message\n    }\n\n    closeAlert() {\n        this.alertElement.style.display = null\n        document.getElementById('alert-message-text').innerHTML = null\n    }\n\n    introSwitchVisibility() {\n        const tmp = d3.select('#intro')\n        if (tmp.style('display') !== 'none') { tmp.style('display', 'none') } else { tmp.style('display', 'block') }\n    }\n\n    popupEditGroupModal(d) {\n        this.editGroupElement.style.display = 'block'\n\n        this.template.fields.forEach((field) => {\n            if (field.type === 'text') {\n                this.editFieldElements[field.header].value = d.data[field.header]\n            } else if (field.type === 'radio') {\n                field.values.forEach((value) => {\n                    const status = (value.header === d.data[field.header])\n                    this.editFieldElements[field.header + '-' + value.header].checked = status\n                })\n            } else if (field.type === 'checkbox') {\n                this.editFieldElements[field.header].checked = d.data[field.header]\n            }\n        })\n        // select first element\n        this.editFieldElements[Object.keys(this.editFieldElements)[0]].select()\n\n        this.editParentElement.innerHTML = d.parent ? d.parent.data.name : 'N/A'\n        const groupData = d.data\n        const group = d\n        d3.select('#edit-submit').on('click', () => { this.editGroup(groupData) })\n        d3.select('#edit-cancel').on('click', () => { this.editGroupElement.style.display = 'none' })\n        d3.select('#edit-delete').on('click', () => { this.removeNode(group) })\n        d3.select('#file-input-subtree').on('change', () => { this.importFileSubtree(group) })\n    }\n\n    editGroup(groupData) {\n        this.template.fields.forEach((field) => {\n            if (field.type === 'text') {\n                groupData[field.header] = this.editFieldElements[field.header].value\n            } else if (field.type === 'radio') {\n                field.values.forEach((value) => {\n                    if (this.editFieldElements[field.header + '-' + value.header].checked) {\n                        groupData[field.header] = value.header\n                    }\n                })\n            } else if (field.type === 'checkbox') {\n                groupData[field.header] = this.editFieldElements[field.header].checked\n            }\n        })\n\n        this.editGroupElement.style.display = 'none'\n        this.redraw()\n    }\n\n    printMap(printType) {\n        // calculate width and height of the map (printed rotated by 90 degrees)\n        const arrNodes = this.nodes.descendants()\n        let minX = 0\n        let maxX = 0\n        let minY = 0\n        let maxY = 0\n        for (let i = 0; i < arrNodes.length; i++) {\n            const x = arrNodes[i].x\n            const y = arrNodes[i].y\n            minX = Math.min(minX, x)\n            maxX = Math.max(maxX, x)\n            minY = Math.min(minY, y)\n            maxY = Math.max(maxY, y)\n        }\n\n        // store original values\n        const origWidth = this.svg.attr('width')\n        const origHeight = this.svg.attr('height')\n        const origTransform = this.g.attr('transform')\n\n        const totalHeight = Math.max(600, this.margin.top + (maxY - minY) + boxHeight + this.margin.top)\n        const totalWidthLeft = Math.max(500, -minX + boxHeight * 1.5 / 2 + 20)\n        const totalWidthRight = Math.max(500, maxX + boxHeight * 1.5 / 2 + 20)\n\n        let translateX, translateY\n        if (printType === 'horizontal') {\n            const printHeight = 700\n            const printWidth = 1200\n\n            // resize for printing\n            this.svg.attr('width', printWidth)\n                .attr('height', printHeight)\n            const printScale = Math.min(1, printWidth / (totalWidthLeft + totalWidthRight), printHeight / totalHeight)\n            translateX = totalWidthLeft * printScale\n            translateY = this.margin.top * printScale\n            this.g.attr('transform', 'translate(' + translateX + ', ' + translateY + ') scale(' + printScale + ')')\n        } else {\n            // resize for printing\n            this.svg.attr('width', totalHeight)\n                .attr('height', totalWidthLeft + totalWidthRight)\n            translateX = totalHeight - this.margin.top\n            translateY = totalWidthLeft\n            this.g.attr('transform', 'translate(' + translateX + ', ' + translateY + ') rotate(90)')\n        }\n\n        // change CSS for printing\n        d3.select('#left-menu').style('display', 'none')\n        d3.select('#main').style('float', 'left')\n        d3.selectAll('#main-svg').style('background', 'white')\n\n        window.print()\n\n        // change CSS back after printing\n        this.svg.attr('width', origWidth)\n            .attr('height', origHeight)\n        this.g.attr('transform', origTransform)\n        d3.select('#left-menu').style('display', null)\n        d3.select('#main').style('float', null)\n        d3.selectAll('#main-svg').style('background', null)\n    }\n\n    redraw() {\n        // declares a tree layout and assigns the size\n        const tree = d3.tree()\n            .nodeSize([this.template.settings.nodeSize.width,\n            this.template.settings.nodeSize.height])\n            .separation(function separation(a, b) {\n                return a.parent === b.parent ? 1 : 1.2\n            })\n\n        const stratifiedData = d3.stratify()(this.data)\n        this.nodes = tree(stratifiedData)\n        // update the links between the nodes\n        const link = this.gLinks.selectAll('.link')\n            .data(this.nodes.descendants().slice(1))\n\n        link.exit()\n            .remove()\n\n        link.enter()\n            .append('path')\n            .merge(link)\n            .attr('class', 'link')\n            .attr('d', function (d) {\n                return 'M' + d.x + ',' + d.y +\n                    'C' + d.x + ',' + (d.y + (d.parent.y + boxHeight)) / 2 +\n                    ' ' + d.parent.x + ',' + (d.y + (d.parent.y + boxHeight)) / 2 +\n                    ' ' + d.parent.x + ',' + (d.parent.y + boxHeight)\n            })\n\n        // update the link text between the nodes\n        const LINK_TEXT_POSITION = 0.3 // 1 -> parent, 0 -> child\n        const linkText = this.gLinksText.selectAll('.link-text')\n            .data(this.nodes.descendants().slice(1))\n        linkText.exit()\n            .remove()\n        linkText.enter()\n            .append('text')\n            .merge(linkText)\n            .attr('class', function (d) {\n                return 'link-text ' + (d.data.active ? ' link-text--active' : ' link-text--inactive')\n            })\n            .attr('x', function (d) { return d.x * (1 - LINK_TEXT_POSITION) + d.parent.x * LINK_TEXT_POSITION })\n            .attr('y', function (d) { return d.y * (1 - LINK_TEXT_POSITION) + (d.parent.y + boxHeight) * LINK_TEXT_POSITION })\n            .text(function (d) { return d.data.coach })\n\n        // update nodes\n        const node = this.gNodes.selectAll('.node')\n            .data(this.nodes.descendants())\n\n        node.exit()\n            .remove()\n\n        // NEW ELEMENTS\n        const newGroup = node.enter()\n            .append('g')\n\n        newGroup.append('title').text('Edit group')\n        this.appendRemoveButton(newGroup)\n        this.appendAddButton(newGroup)\n\n        // append SVG elements without fields\n        Object.keys(this.template.svg).forEach((svgElement) => {\n            const svgElementValue = this.template.svg[svgElement]\n            const element = newGroup.append(svgElementValue['type'])\n            element.attr('class', 'node-' + svgElement)\n        })\n\n        // append SVG elements related to fields\n        this.template.fields.forEach((field) => {\n            if (field.svg) {\n                const element = newGroup.append(field.svg['type'])\n                element.attr('class', 'node-' + field.header)\n                Object.keys(field.svg.attributes).forEach((attribute) => {\n                    element.attr(attribute, field.svg.attributes[attribute])\n                })\n                if (field.svg.style) {\n                    Object.keys(field.svg.style).forEach((styleKey) => {\n                        element.style(styleKey, field.svg.style[styleKey])\n                    })\n                }\n            }\n        })\n\n        // UPDATE including NEW\n        const nodeWithNew = node.merge(newGroup)\n        nodeWithNew.attr('class', function (d) {\n            return 'node' + (d.data.active ? ' node--active' : ' node--inactive')\n        })\n            .attr('transform', function (d) {\n                return 'translate(' + d.x + ',' + d.y + ')'\n            })\n            .on('click', (d) => { this.popupEditGroupModal(d) })\n\n        nodeWithNew.select('.removeNode')\n            .on('click', (d) => { this.removeNode(d); d3.event.stopPropagation() })\n\n        nodeWithNew.select('.addNode')\n            .on('click', (d) => { this.addNode(d); d3.event.stopPropagation() })\n\n        // refresh class and attributes in SVG elements without fields\n        // in order to remove any additional classes or settings from inherited fields\n        Object.keys(this.template.svg).forEach((svgElement) => {\n            const svgElementValue = this.template.svg[svgElement]\n            const element = nodeWithNew.select('.node-' + svgElement)\n                .attr('class', 'node-' + svgElement)\n            Object.keys(svgElementValue.attributes).forEach((attribute) => {\n                element.attr(attribute, svgElementValue.attributes[attribute])\n            })\n        })\n\n        // update node elements which have SVG in template\n        this.template.fields.forEach((field) => {\n            if (field.svg) {\n                const element = nodeWithNew.select('.node-' + field.header)\n                this.updateSvgForFields(field, element)\n            }\n            if (field.inheritsFrom) {\n                const element = nodeWithNew.select('.node-' + field.inheritsFrom)\n                this.updateFieldWithInherit(field, element)\n            }\n        })\n    }\n\n    updateFieldWithInherit(field, element) {\n        if (!element.empty()) {\n            if (field.type === 'checkbox') this.updateCheckboxField(field, element)\n            if (field.type === 'radio') this.updateRadioField(field, element)\n        }\n    }\n\n    updateCheckboxField(field, element) {\n        // add class to the element which the field inherits from\n        if (field.class) {\n            element.attr('class', function(d) {\n                const checked = d.data[field.header]\n                const class_ = checked ? field.class.checkedTrue : field.class.checkedFalse\n                return this.classList.value + ' ' + class_\n            })\n        }\n        if (typeof field.attributes !== 'undefined' &&\n            typeof field.attributes.rx !== 'undefined') {\n            element.attr('rx', function (d) {\n                const checked = d.data[field.header]\n                const rxObj = field.attributes.rx\n                const rx = checked ? rxObj.checkedTrue : rxObj.checkedFalse\n                return String(rx)\n            })\n        }\n    }\n\n    updateRadioField(field, element) {\n        // add class to the element which the field inherits from\n        element.attr('class', function(d) {\n            const fieldValue = GenMapper.getFieldValueForRadioType(field, d)\n            if (fieldValue.class) {\n                return this.classList.value + ' ' + fieldValue.class\n            } else {\n                return this.classList.value\n            }\n        })\n        element.attr('rx', function(d) {\n            const fieldValue = GenMapper.getFieldValueForRadioType(field, d)\n            if (typeof fieldValue.attributes !== 'undefined' &&\n                typeof fieldValue.attributes.rx !== 'undefined') {\n                return String(fieldValue.attributes.rx)\n            } else {\n                return this.rx.baseVal.valueAsString\n            }\n        })\n    }\n\n    static getFieldValueForRadioType(field, d) {\n        let fieldValue = _.where(field.values, { header: d.data[field.header] })[0]\n        if (typeof fieldValue === 'undefined') {\n            fieldValue = _.where(field.values, { header: field.initial })[0]\n        }\n        return fieldValue\n    }\n\n    updateSvgForFields(field, element) {\n        element.text(function (d) { return d.data[field.header] })\n        if (field.svg.type === 'image') {\n            element.style('display', function (d) { return d.data[field.header] ? 'block' : 'none' })\n        }\n    }\n\n    appendRemoveButton(group) {\n        group.append('g')\n            .attr('class', 'removeNode')\n            .append('svg')\n            .html(\n            '<rect x=\"40\" y=\"0\" rx=\"7\" width=\"25\" height=\"40\">' +\n            '<title>Remove group &amp; subtree</title>' +\n            '</rect>' +\n            '<line x1=\"46\" y1=\"13.5\" x2=\"59\" y2=\"26.5\" stroke=\"white\" stroke-width=\"3\"></line>' +\n            '<line x1=\"59\" y1=\"13.5\" x2=\"46\" y2=\"26.5\" stroke=\"white\" stroke-width=\"3\"></line>'\n            )\n    }\n\n    appendAddButton(group) {\n        group.append('g')\n            .attr('class', 'addNode')\n            .append('svg')\n            .html(\n            '<rect x=\"40\" y=\"40\" rx=\"7\" width=\"25\" height=\"40\">' +\n            '<title>Add child</title>' +\n            '</rect>' +\n            '<line x1=\"45\" y1=\"60\" x2=\"60\" y2=\"60\" stroke=\"white\" stroke-width=\"3\"></line>' +\n            '<line x1=\"52.5\" y1=\"52.5\" x2=\"52.5\" y2=\"67.5\" stroke=\"white\" stroke-width=\"3\"></line>'\n            )\n    }\n\n    addNode(d) {\n        const newNodeData = {}\n        this.template.fields.forEach((field) => {\n            newNodeData[field.header] = field.initial\n        })\n        newNodeData['id'] = this.findNewId()\n        newNodeData['parentId'] = d.data.id\n        this.data.push(newNodeData)\n        this.redraw()\n    }\n\n    findNewId() {\n        const ids = _.map(this.data, function (row) { return row.id })\n        return this.findNewIdFromArray(ids)\n    }\n\n    /*\n     * Find smallest int >= 0 not in array\n     */\n    findNewIdFromArray(arr) {\n        // copy and sort\n        arr = arr.slice().sort(function (a, b) { return a - b })\n        let tmp = 0\n        for (let i = 0; i < arr.length; i++) {\n            if (arr[i] >= 0) { // ids must be >= 0\n                if (arr[i] === tmp) {\n                    tmp += 1\n                } else {\n                    break\n                }\n            }\n        }\n        return tmp\n    }\n\n    removeNode(d) {\n        if (!d.parent) {\n            this.displayAlert('Sorry. Deleting root group is not possible.')\n        } else {\n            let confirmMessage\n            if (!d.children) {\n                confirmMessage = 'Do you really want to delete ' + d.data.name + '?'\n            } else {\n                confirmMessage = 'Do you really want to delete ' + d.data.name + ' and all descendants?'\n            }\n            if (window.confirm(confirmMessage)) {\n                this.deleteAllDescendants(d)\n                const nodeToDelete = _.where(this.data, { id: d.data.id })\n                if (nodeToDelete) {\n                    this.data = _.without(this.data, nodeToDelete[0])\n                }\n            }\n        }\n        document.getElementById('edit-group').style.display = 'none'\n        this.redraw()\n    }\n\n    parseCsvData(csvData) {\n        return d3.csvParse(csvData, (d)=> {\n            const parsedId = parseInt(d.id)\n            if (parsedId < 0 || isNaN(parsedId)) { throw new Error('Group id must be integer >= 0.') }\n            const parsedLine = {}\n            parsedLine['id'] = parsedId\n            parsedLine['parentId'] = d.parentId !== '' ? parseInt(d.parentId) : ''\n            this.template.fields.forEach((field) => {\n                if (field.type === 'checkbox') {\n                    const fieldValue = d[field.header].toUpperCase()\n                    parsedLine[field.header] = !!['TRUE', '1'].includes(fieldValue)\n                } else if (field.type) {\n                    parsedLine[field.header] = d[field.header]\n                }\n            })\n            return parsedLine\n        })\n    }\n    \n    getCSVOut() {\n        return d3.csvFormatRows(data.map(function (d, i) {\n            const output = []\n            template.fields.forEach(function (field) {\n                if (field.type === 'checkbox') {\n                output.push(d[field.header] ? '1' : '0')\n                } else {\n                output.push(d[field.header])\n                }\n            }\n            )\n            return output\n        }))\n    }\n\n    outputString() {\n        return this.csvHeader + this.getCSVOut();\n    }\n    \n    outputCsv() {\n        const out = d3.csvFormatRows(this.data.map( (d, i)=> {\n            const output = []\n            this.template.fields.forEach((field) => {\n                if (field.type === 'checkbox') {\n                    output.push(d[field.header] ? '1' : '0')\n                } else {\n                    output.push(d[field.header])\n                }\n            })\n            return output\n        }))\n        const blob = new Blob([this.csvHeader + out], { type: 'text/csv;charset=utf-8' })\n        const isSafari = navigator.vendor && navigator.vendor.indexOf('Apple') > -1 &&\n            navigator.userAgent && !navigator.userAgent.match('CriOS')\n        const promptMessage = isSafari ? 'Save as: \\n(Note: Safari browser has issues with export, please see GenMapper -> Help for more info)' : 'Save as:'\n        const saveName = window.prompt(promptMessage, this.projectName + '.csv')\n        if (saveName === null) return\n        saveAs(blob, saveName)\n    }\n\n    parseTransform(a) {\n        const b = {}\n        for (let i in a = a.match(/(\\w+\\((-?\\d+.?\\d*e?-?\\d*,?)+\\))+/g)) {\n            const c = a[i].match(/[\\w.-]+/g)\n            b[c.shift()] = c\n        }\n        return b\n    }\n\n    importFile() {\n        this.importFileFromInput('file-input', (filedata, filename) => {\n            const parsedCsv = this.parseAndValidateCsv(filedata, filename)\n            if (parsedCsv === null) { return }\n            this.data = parsedCsv\n            this.redraw()\n        })\n    }\n\n    importFileSubtree(d) {\n        if (!window.confirm('Warning: Importing subtreee will overwrite this group (' + d.data.name + ') and all descendants. Do you want to continue?')) {\n            return\n        }\n        this.importFileFromInput('file-input-subtree', (filedata, filename) => {\n            const parsedCsv = this.parseAndValidateCsv(filedata, filename)\n            if (parsedCsv === null) { return }\n            this.csvIntoNode(d, parsedCsv)\n            this.redraw()\n            this.editGroupElement.style.display = 'none'\n        })\n    }\n\n    /**\n     * If error occurs, displays error and returns null\n     * If not, raises error\n     */\n    parseAndValidateCsv(filedata, filename) {\n        try {\n            const csvString = this.fileToCsvString(filedata, filename)\n            const parsedCsv = this.parseCsvData(csvString)\n            this.validTree(parsedCsv)\n            return parsedCsv\n        } catch (err) {\n            this.displayImportError(err)\n            return null\n        }\n    }\n\n    /**\n     * Checks if parsedCsv creates a valid tree.\n     * If not, raises error\n     */\n    validTree(parsedCsv) {\n        const treeTest = d3.tree()\n        const stratifiedDataTest = d3.stratify()(parsedCsv)\n        treeTest(stratifiedDataTest)\n    }\n\n    displayImportError(err) {\n        if (err.toString().includes('>= 0.') || err.toString().includes('Wrong type')) {\n            this.displayAlert('Error when importing file. <br>' + err.toString())\n        } else {\n            this.displayAlert('Error when importing file.<br><br>Please check that the file is in correct format' +\n                '(comma separated values), that the root group has no parent, and that all other' +\n                'relationships make a valid tree.<br><br>Also check that you use the correct version of the App.')\n        }\n    }\n\n    deleteAllDescendants(d) {\n        let idsToDelete = _.map(d.children, function (row) { return parseInt(row.id) })\n        while (idsToDelete.length > 0) {\n            const currentId = idsToDelete.pop()\n            const childrenIdsToDelete = _.map(_.where(this.data, { parentId: currentId }),\n                function (row) { return row.id })\n            idsToDelete = idsToDelete.concat(childrenIdsToDelete)\n            const nodeToDelete = _.where(this.data, { id: currentId })\n            if (nodeToDelete) { this.data = _.without(this.data, nodeToDelete[0]) }\n        }\n    }\n\n    csvIntoNode(d, parsedCsv) {\n        this.deleteAllDescendants(d)\n\n        // replace node by root of imported\n        const nodeToDelete = _.where(this.data, { id: d.data.id })[0]\n        const rowRootOfImported = _.where(parsedCsv, { parentId: '' })[0]\n        const mapOldIdToNewId = {}\n        mapOldIdToNewId[rowRootOfImported.id] = nodeToDelete.id\n        parsedCsv = _.without(parsedCsv, rowRootOfImported)\n        rowRootOfImported.id = nodeToDelete.id\n        rowRootOfImported.parentId = nodeToDelete.parentId\n        this.data[_.indexOf(this.data, nodeToDelete)] = rowRootOfImported\n\n        const idsUnsorted = _.map(this.data, function (row) { return row.id })\n        const ids = idsUnsorted.sort(function (a, b) { return a - b })\n        // update ids of other nodes and push into data\n        while (parsedCsv.length > 0) {\n            const row = parsedCsv.pop()\n            if (!(row.id in mapOldIdToNewId)) {\n                const newId = this.findNewIdFromArray(ids)\n                mapOldIdToNewId[row.id] = newId\n                ids.push(newId)\n            }\n            if (!(row.parentId in mapOldIdToNewId)) {\n                const newId = this.findNewIdFromArray(ids)\n                mapOldIdToNewId[row.parentId] = newId\n                ids.push(newId)\n            }\n            // change id and parentId\n            row.id = mapOldIdToNewId[row.id]\n            row.parentId = mapOldIdToNewId[row.parentId]\n            this.data.push(row)\n        }\n    }\n\n    importFileFromInput(fileInputElementId, callback) {\n        if (typeof window.FileReader !== 'function') {\n            this.displayAlert(\"The file API isn't supported on this browser yet.\")\n            return\n        }\n\n        const input = document.getElementById(fileInputElementId)\n        if (!input) {\n            this.displayAlert(\"Um, couldn't find the fileinput element.\")\n        } else if (!input.files) {\n            this.displayAlert(\"This browser doesn't seem to support the 'files' property of file inputs.\")\n        } else if (!input.files[0]) {\n            this.displayAlert('Please select a file')\n        } else {\n            const file = input.files[0]\n            const filename = file.name\n            const fr = new FileReader()\n            fr.onload = () => {\n                const filedata = fr.result\n                callback(filedata, filename)\n            }\n            const extension = /(?:\\.([^.]+))?$/.exec(filename)[1]\n            if (extension === 'csv') {\n                fr.readAsText(file)\n            } else {\n                fr.readAsBinaryString(file)\n            }\n        }\n    }\n\n    fileToCsvString(filedata, filename) {\n        const regex = /(?:\\.([^.]+))?$/\n        const extension = regex.exec(filename)[1].toLowerCase()\n        let csvString\n\n        if (extension === 'xls' || extension === 'xlsx') {\n            const workbook = XLSX.read(filedata, { type: 'binary' })\n            const worksheet = workbook.Sheets[workbook.SheetNames[0]]\n            csvString = XLSX.utils.sheet_to_csv(worksheet)\n        } else if (extension === 'csv') {\n            csvString = filedata\n        } else {\n            throw new Error('Wrong type of file. Please import xls, xlsx or csv files.')\n        }\n        csvString = csvString.replace(/\\r\\n?/g, '\\n')\n        // replace first line with a default one\n        return this.csvHeader + csvString.substring(csvString.indexOf('\\n') + 1)\n    }\n\n    addFieldsToEditWindow() {\n        this.template.fields.forEach((field) => {\n            if (field.type) {\n                // add table row\n                const tr = d3.select('#edit-group-content')\n                    .select('form')\n                    .select('table')\n                    .append('tr')\n                // add left column\n                tr.append('td')\n                    .text(field.description + ':')\n                    .attr('class', 'left-field')\n                // add right column\n                const td = tr.append('td')\n                    .attr('class', 'right-field')\n                if (field.type === 'radio') {\n                    for (let value of field.values) {\n                        td.append('input')\n                            .attr('type', field.type)\n                            .attr('name', field.header)\n                            .attr('value', value.header)\n                            .attr('id', 'edit-' + field.header + '-' + value.header)\n                        td.append('span')\n                            .html(value.description)\n                        td.append('br')\n                    }\n                } else {\n                    td.append('input')\n                        .attr('type', field.type)\n                        .attr('name', field.header)\n                        .attr('id', 'edit-' + field.header)\n                }\n            }\n        })\n    }\n}","import { FileService } from 'services/fileservice';\nimport { inject, Factory } from 'aurelia-framework';\nimport { GenMapper } from './genmapper';\n\n@inject(FileService, Factory.of(GenMapper))\nexport class MapViewModel {\n\n    constructor(fileService: FileService, GenMapper:Factory<genmapper>) {\n        this.fileService = fileService;\n        this.GenMapper = GenMapper;\n    }\n\n    activate(params) {\n        this.format = params.type;\n        this.model = this.fileService.current;\n        \n        this.genmapper = this.GenMapper({\n            model: this.model,\n            format: this.format\n        });\n    }\n\n    save() {\n        let content = this.genmapper.outputString();\n        \n        console.log(content);\n        // this.fileService.update(this.model);\n    }\n}","const boxHeight = 80\nconst textHeight = 14\nconst textMargin = 6\n\nconst CHURCH_CIRCLES = {\n  'name': 'Church circles 0.4',\n  'settings': {\n    'nodeSize': {\n      'width': boxHeight * 1.5,\n      'height': boxHeight * 2.1\n    }\n  },\n  'svg': {\n    'big-rect': {\n      // Rect with opacity 0, so that one could hover over all the square even\n      // if the visible shape is circle\n      'type': 'rect',\n      'attributes': {\n        'x': -boxHeight / 2,\n        'y': 0,\n        'width': boxHeight,\n        'height': boxHeight,\n        'opacity': '0'\n      }\n    },\n    'attenders-image': {\n      'type': 'image',\n      'attributes': {\n        'x': -boxHeight * 0.5,\n        'y': -2.5 * textHeight,\n        'width': boxHeight / 4,\n        'height': boxHeight / 4,\n        'href': 'icons/attenders.png'\n      }\n    },\n    'believers-image': {\n      'type': 'image',\n      'attributes': {\n        'x': -boxHeight * 0.25,\n        'y': -2.5 * textHeight,\n        'width': boxHeight / 4,\n        'height': boxHeight / 4,\n        'href': 'icons/believers.png'\n      }\n    },\n    'baptized-image': {\n      'type': 'image',\n      'attributes': {\n        'x': boxHeight * 0.1,\n        'y': -2.5 * textHeight,\n        'width': boxHeight / 4,\n        'height': boxHeight / 4,\n        'href': 'icons/element-baptism.png'\n      }\n    },\n    'church-box': {\n      'type': 'rect',\n      'attributes': {\n        'x': -boxHeight / 2,\n        'y': 0,\n        'rx': 0.5 * boxHeight,\n        'width': boxHeight,\n        'height': boxHeight\n      }\n    }\n  },\n  'fields': [\n    {\n      'header': 'id',\n      'initial': 0,\n      'description': 'Id',\n      'type': null\n    },\n    {\n      'header': 'parentId',\n      'initial': null,\n      'description': 'Parent',\n      'type': null\n    },\n    {\n      'header': 'name',\n      'initial': \"Leader's Name\",\n      'description': \"Leader's Name\",\n      'type': 'text',\n      'svg': {\n        'type': 'text',\n        'attributes': {\n          'x': 0,\n          'y': boxHeight + textHeight\n        }\n      }\n    },\n    {\n      'header': 'email',\n      'initial': null,\n      'description': 'Email',\n      'type': 'text'\n    },\n    {\n      'header': 'link',\n      'initial': null,\n      'description': 'Link',\n      'type': 'text'\n    },\n    {\n      'header': 'attenders',\n      'initial': 0,\n      'description': '# of Attenders',\n      'type': 'text',\n      'svg': {\n        'type': 'text',\n        'attributes': {\n          'x': -boxHeight * 0.39,\n          'y': -0.5 * textMargin\n        },\n        'style': {\n          'text-anchor': 'center'\n        }\n      }\n    },\n    {\n      'header': 'believers',\n      'initial': 0,\n      'description': '# of Believers',\n      'type': 'text',\n      'svg': {\n        'type': 'text',\n        'attributes': {\n          'x': -boxHeight * 0.13,\n          'y': -0.5 * textMargin\n        },\n        'style': {\n          'text-anchor': 'center'\n        }\n      }\n    },\n    {\n      'header': 'baptized',\n      'initial': 0,\n      'description': '# of Baptized',\n      'type': 'text',\n      'svg': {\n        'type': 'text',\n        'attributes': {\n          'x': boxHeight * 0.13,\n          'y': -0.5 * textMargin\n        },\n        'style': {\n          'text-anchor': 'center'\n        }\n      }\n    },\n    {\n      'header': 'newlyBaptized',\n      'initial': 0,\n      'description': '# of New Baptized (since church start)',\n      'type': 'text',\n      'svg': {\n        'type': 'text',\n        'attributes': {\n          'x': boxHeight * 0.39,\n          'y': -0.5 * textMargin\n        },\n        'style': {\n          'text-anchor': 'center'\n        }\n      }\n    },\n    {\n      'header': 'church',\n      'initial': false,\n      'description': 'Is church?',\n      'type': 'checkbox',\n      'inheritsFrom': 'church-box',\n      'class': {\n        'checkedTrue': 'is-church',\n        'checkedFalse': 'is-not-church'\n      }\n    },\n    {\n      'header': 'churchType',\n      'initial': 'newBelievers',\n      'description': 'Church Type',\n      'type': 'radio',\n      'inheritsFrom': 'church-box',\n      'values': [\n        {\n          'header': 'legacy',\n          'description': 'Legacy',\n          'class': 'church-legacy',\n          'attributes': {\n            'rx': 0\n          }\n        },\n        {\n          'header': 'existingBelievers',\n          'description': 'Existing Believers',\n          'attributes': {\n            'rx': 0\n          }\n        },\n        {\n          'header': 'newBelievers',\n          'description': 'New Believers'\n        }\n      ]\n    },\n    {\n      'header': 'elementBaptism',\n      'initial': false,\n      'description': 'Element: Baptism',\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': -boxHeight * 0.4,\n          'y': boxHeight * 0.1,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-baptism.png'\n        }\n      }\n    },\n    {\n      'header': 'elementWord',\n      'initial': false,\n      'description': \"Element: God's Word\",\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': -boxHeight * 0.125,\n          'y': boxHeight * 0.1,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-word.png'\n        }\n      }\n    },\n    {\n      'header': 'elementPrayer',\n      'initial': false,\n      'description': 'Element: Prayer',\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': boxHeight * 0.15,\n          'y': boxHeight * 0.1,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-prayer.png'\n        }\n      }\n    },\n    {\n      'header': 'elementLordsSupper',\n      'initial': false,\n      'description': \"Element: Lord's supper\",\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': -boxHeight * 0.4,\n          'y': boxHeight * 0.375,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-lords-supper.png'\n        }\n      }\n    },\n    {\n      'header': 'elementGive',\n      'initial': false,\n      'description': 'Element: Giving',\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': -boxHeight * 0.125,\n          'y': boxHeight * 0.375,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-give.png'\n        }\n      }\n    },\n    {\n      'header': 'elementLove',\n      'initial': false,\n      'description': 'Element: Love',\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': boxHeight * 0.15,\n          'y': boxHeight * 0.375,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-love.png'\n        }\n      }\n    },\n    {\n      'header': 'elementWorship',\n      'initial': false,\n      'description': 'Element: Worship',\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': -boxHeight * 0.4,\n          'y': boxHeight * 0.65,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-worship.png'\n        }\n      }\n    },\n    {\n      'header': 'elementLeaders',\n      'initial': false,\n      'description': 'Element: Leaders',\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': -boxHeight * 0.125,\n          'y': boxHeight * 0.65,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-leaders.png'\n        }\n      }\n    },\n    {\n      'header': 'elementMakeDisciples',\n      'initial': false,\n      'description': 'Element: Make disciples',\n      'type': 'checkbox',\n      'svg': {\n        'type': 'image',\n        'attributes': {\n          'x': boxHeight * 0.15,\n          'y': boxHeight * 0.65,\n          'width': boxHeight / 4,\n          'height': boxHeight / 4,\n          'xlink:href': 'icons/element-make-disciples.png'\n        }\n      }\n    },\n    {\n      'header': 'place',\n      'initial': 'Place',\n      'description': 'Place',\n      'type': 'text',\n      'svg': {\n        'type': 'text',\n        'attributes': {\n          'x': 0,\n          'y': boxHeight + 2 * textHeight\n        }\n      }\n    },\n    {\n      'header': 'date',\n      'initial': 'Date',\n      'description': 'Date of Start (Finish)',\n      'type': 'text',\n      'svg': {\n        'type': 'text',\n        'attributes': {\n          'x': 0,\n          'y': boxHeight + 3 * textHeight\n        }\n      }\n    },\n    {\n      'header': 'threeThirds',\n      'initial': '1234567',\n      'description': 'Elements of 3/3 process (see help for details)',\n      'type': 'text',\n      'svg': {\n        'type': 'text',\n        'attributes': {\n          'x': boxHeight * -0.7,\n          'y': boxHeight * 0.6,\n          'transform': 'rotate(90 -56 48)',\n          'rotate': -90\n        },\n        'style': {\n          'text-anchor': 'center',\n          'letter-spacing': '0.35em'\n        }\n      }\n    },\n    {\n      'header': 'active',\n      'initial': true,\n      'description': 'Active',\n      'type': 'checkbox'\n      // svg defined currently in genmapper.js\n    }\n  ]\n}\n\n\nexport { CHURCH_CIRCLES, boxHeight, textHeight, textMargin }","\nexport class Category {\n\n}\n","\nexport class Home {\n  constructor() {\n    this.categories = [\n      {\n        name: 'Entry',\n        tools: [\n          {\n            name: 'Four Fields GenMap',\n            image: 'assets/fourFields-genmap.png'\n          },\n          {\n            name: 'Church Circles GenMap',\n            image: 'assets/churchCircles-genmap.png'\n          },\n          {\n            name: 'Four Fields GenMap',\n            image: 'assets/fourFields-genmap.png'\n          }\n        ]\n      },\n      {\n        name: 'Gospel',\n        tools: [\n          {\n            name: 'Four Fields GenMap',\n            image: 'assets/fourFields-genmap.png'\n          },\n          {\n            name: 'Church Circles GenMap',\n            image: 'assets/churchCircles-genmap.png'\n          },\n          {\n            name: 'Four Fields GenMap',\n            image: 'assets/fourFields-genmap.png'\n          }\n        ]\n      },\n      {\n        name: 'Church Formation',\n        tools: [\n          {\n            name: 'Four Fields GenMap',\n            image: 'assets/fourFields-genmap.png'\n          },\n          {\n            name: 'Church Circles GenMap',\n            image: 'assets/churchCircles-genmap.png'\n          },\n          {\n            name: 'Four Fields GenMap',\n            image: 'assets/fourFields-genmap.png'\n          }\n        ]\n      },\n      {\n        name: 'Discipleship',\n        tools: [\n          {\n            name: 'Four Fields GenMap',\n            image: 'assets/fourFields-genmap.png'\n          },\n          {\n            name: 'Church Circles GenMap',\n            image: 'assets/churchCircles-genmap.png'\n          },\n          {\n            name: 'Four Fields GenMap',\n            image: 'assets/fourFields-genmap.png'\n          }\n        ]\n      }\n    ];\n  }\n}\n","import { observable } from 'aurelia-framework';\n\nexport class Tool {\n  canPersist = true;\n  @observable title = '';\n  loaded = '';\n  editorDirty = false;\n  titleDirty = false;\n  content = '';\n\n  titleChanged() {\n    this.titleDirty = (this.loaded !== this.title);\n  }\n\n  get dirty() {\n    return this.editorDirty || this.titleDirty;\n  }\n\n  save() {\n\n  }\n\n  load() {\n\n  }\n}\n"],"sourceRoot":".."}